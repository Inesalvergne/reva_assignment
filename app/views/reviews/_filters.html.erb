<div class=" bg-white shadow-lg rounded-lg p-6 border border-gray-200 z-10 mb-8 md:mb-0"
     data-drawer-target="panel">

  <%= form_with url: reviews_path, method: :get,
      data: {
        controller: "autosubmit",
        turbo_frame: :reviews,
        turbo_action: "advance"
      },
      class: "divide-y divide-gray-200" do |f| %>

    <!-- Company -->
    <div class="pb-4">
      <label class="block text-sm font-medium text-gray-700 mb-2">Company</label>
      <%= f.select :company,
          options_for_select([["All companies", ""]] + Company.order(:name).pluck(:name), params[:company]),
          {},
          class: "w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-reva-blue focus:border-reva-blue",
          data: { action: "change->autosubmit#submit" } %>
    </div>

    <!-- Search -->
    <div class="py-4">
      <label class="block text-sm font-medium text-gray-700 mb-2">Description</label>
      <%= f.text_field :search,
          value: params[:search],
          placeholder: "Search reviews...",
          class: "w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500",
          data: {
            action: "input->autosubmit#submit",
          } %>
    </div>

    <!-- Ratings -->
    <div class="py-4">
      <label class="block text-sm font-medium text-gray-700 mb-3">
        Rating
      </label>
      <div class="space-y-2">
        <% (1..5).reverse_each do |rating| %>
          <label class="flex items-center cursor-pointer hover:bg-gray-50 -mx-2 px-2 py-1 rounded">
            <%= check_box_tag "ratings[]", rating,
                (params[:ratings] || []).include?(rating.to_s),
                id: "rating_#{rating}",
                class: "h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded",
                data: { action: "change->autosubmit#submit" } %>
            <span class="ml-3 text-sm text-gray-700">
              <span class="text-yellow-400"><%= '★' * rating %></span>
              <span class="text-gray-300"><%= '★' * (5 - rating) %></span>
              <span class="text-gray-500 ml-1">(<%= rating %>)</span>
            </span>
          </label>
        <% end %>
      </div>
    </div>

    <!-- Channels -->
    <div class="py-4">
      <label class="block text-sm font-medium text-gray-700 mb-3">
        Channel
      </label>
      <div class="space-y-2">
        <% Review.channels.keys.each do |channel| %>
          <label class="flex items-center cursor-pointer hover:bg-gray-50 -mx-2 px-2 py-1 rounded">
            <%= check_box_tag "channels[]", channel,
                (params[:channels] || []).include?(channel),
                id: "channel_#{channel}",
                class: "h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded",
                data: { action: "change->autosubmit#submit" } %>
            <span class="ml-3 text-sm text-gray-700 capitalize">
              <%= channel.titleize %>
            </span>
          </label>
        <% end %>
      </div>
    </div>

    <!-- Date Range -->
    <div class="py-6">
      <label class="block text-sm font-medium text-gray-700 mb-2">
        Date Range
      </label>
      <div class="space-y-3 flex gap-6">
        <div>
          <label class="block text-xs text-gray-500 mb-1">From</label>
          <%= f.date_field :start_date,
              value: params[:start_date],
              class: "w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500",
              data: { action: "change->autosubmit#submit" } %>
        </div>
        <div>
          <label class="block text-xs text-gray-500 mb-1">To</label>
          <%= f.date_field :end_date,
              value: params[:end_date],
              class: "w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500",
              data: { action: "change->autosubmit#submit" } %>
        </div>
      </div>
    </div>
  <% end %>
</div>
